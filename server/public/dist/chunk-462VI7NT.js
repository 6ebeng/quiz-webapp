import{a as j}from"./chunk-2YWRYQGB.js";import{a as T}from"./chunk-IARSFAES.js";import{$ as q,Ba as U,Bb as F,Cb as w,Ka as P,La as L,Q as I,Qa as R,S as n,V as C,Y as k,Z as g,_a as v,ba as d,bb as x,da as i,ea as o,fa as y,ha as p,ia as E,m as M,oa as r,pa as l,r as b,u as _,y as u,ya as O}from"./chunk-3B37LIQD.js";function B(s,z){if(s&1&&(i(0,"tr")(1,"td",13),r(2),o(),i(3,"td",13),y(4,"img",14),o(),i(5,"td"),r(6),o(),i(7,"td"),r(8),o(),i(9,"td"),r(10),o(),i(11,"td"),r(12),o(),i(13,"td"),r(14),o(),i(15,"td"),r(16),o()()),s&2){let t=z.$implicit,a=z.index,e=E();n(2),l(a+1),n(2),d("src",t.imageUrl?e.imgDir+t.imageUrl:e.defaultImg,I),n(2),l(t.username),n(2),l(t.age),n(2),l(t.quizzes),n(2),l(t.questions),n(2),l(t.score),n(2),l(t.averageScore)}}var N=(()=>{class s{constructor(t,a){this.userService=t,this.quizService=a,this.users=[],this.usersSubscription=null,this.quizResults=[],this.quizResultsSubscription=null,this.imgDir=x.API_URL+"/assets/uploads/",this.defaultImg=x.API_URL+"/assets/img/avatar.png",this.sortCol="",this.sortUp=!0}ngOnInit(){M({usersResponse:this.userService.getUsers().pipe(_(t=>t.length===0),b(1)),quizResultsResponse:this.quizService.getQuizResults().pipe(_(t=>t.length===0),b(1))}).subscribe({next:({usersResponse:t,quizResultsResponse:a})=>{this.users=t,this.quizResults=a,this.users.forEach(e=>{let c=this.quizResults.filter(m=>m.userId===e.id),h=0,f=0,S=0;c.forEach(m=>{h++,f+=m.score,S+=m.totalQuestions});let A=h>0?f/S*100:0;e.quizzes=h,e.questions=S,e.score=f,e.averageScore=parseFloat(A.toFixed(2))}),this.users=this.users.filter(e=>e.quizzes)},error:t=>{console.error(t)}})}toggleSortDirection(){this.sortUp=!this.sortUp}setSortColumn(t){this.sortCol=t,this.sortUp=!this.sortUp}isSelected(t){return t==this.sortCol}ngOnDestroy(){this.usersSubscription&&this.usersSubscription.unsubscribe(),this.quizResultsSubscription&&this.quizResultsSubscription.unsubscribe()}static{this.\u0275fac=function(a){return new(a||s)(C(j),C(T))}}static{this.\u0275cmp=k({type:s,selectors:[["app-leaderboard"]],standalone:!1,decls:39,vars:17,consts:[[1,"container"],[1,"row","justify-content-center"],[1,"col-md-9","col-xxl-7","px-md-4","mt-5","mt-md-5"],[1,"table","table-responsive","mt-3"],[1,"table-header","text-center"],["id","username",1,"sortable",3,"click"],[3,"ngClass"],["id","age",1,"sortable",3,"click"],["id","quizzes",1,"sortable",3,"click"],["id","questions",1,"sortable",3,"click"],["id","score",1,"sortable",3,"click"],["id","averageScore",1,"sortable",3,"click"],[4,"ngFor","ngForOf"],[1,"text-center"],["alt","profile img",1,"profile-img",3,"src"]],template:function(a,e){a&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),r(4,"Leaderboard"),o(),i(5,"table",3)(6,"thead")(7,"tr",4)(8,"th"),r(9,"Id"),o(),i(10,"th"),r(11,"Img"),o(),i(12,"th",5),p("click",function(){return e.setSortColumn("username")}),r(13,"Username "),i(14,"span",6),r(15),o()(),i(16,"th",7),p("click",function(){return e.setSortColumn("age")}),r(17,"Age "),i(18,"span",6),r(19),o()(),i(20,"th",8),p("click",function(){return e.setSortColumn("quizzes")}),r(21,"Total quizzes "),i(22,"span",6),r(23),o()(),i(24,"th",9),p("click",function(){return e.setSortColumn("questions")}),r(25,"Total questions "),i(26,"span",6),r(27),o()(),i(28,"th",10),p("click",function(){return e.setSortColumn("score")}),r(29,"Total score "),i(30,"span",6),r(31),o()(),i(32,"th",11),p("click",function(){return e.setSortColumn("averageScore")}),r(33,"Average score % "),i(34,"span",6),r(35),o()()()(),i(36,"tbody"),q(37,B,17,8,"tr",12),O(38,"sort"),o()()()()()),a&2&&(n(14),d("ngClass",e.isSelected("username")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(3),d("ngClass",e.isSelected("age")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(3),d("ngClass",e.isSelected("quizzes")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(3),d("ngClass",e.isSelected("questions")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(3),d("ngClass",e.isSelected("score")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(3),d("ngClass",e.isSelected("averageScore")?"colored":"transparent"),n(),l(e.sortUp?"\u2191":"\u2193"),n(2),d("ngForOf",U(38,13,e.users,e.sortCol,e.sortUp)))},dependencies:[P,L,F],styles:["h1[_ngcontent-%COMP%]{font-size:1.1em}.profile-img[_ngcontent-%COMP%]{display:block;overflow:hidden;width:25px;height:25px;padding:2px;border:1px solid lightgray;border-radius:6px}.table[_ngcontent-%COMP%]{border-collapse:collapse;max-width:100%}thead[_ngcontent-%COMP%]{border:1px solid rgb(240,240,240)}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:8px;text-align:center}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400;background-color:#f5f5f580}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid rgb(230,230,230)}.sortable[_ngcontent-%COMP%]{cursor:pointer}.transparent[_ngcontent-%COMP%]{color:transparent}.colored[_ngcontent-%COMP%]{color:#000}"]})}}return s})();var J=[{path:"",component:N}],Q=(()=>{class s{static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275mod=g({type:s})}static{this.\u0275inj=u({imports:[v.forChild(J),v]})}}return s})();var se=(()=>{class s{static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275mod=g({type:s})}static{this.\u0275inj=u({imports:[R,Q,w]})}}return s})();export{se as a};
